<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Quản lý nhân viên</title>
    <link rel="stylesheet" th:href="@{/assets/css/vendor.min.css}">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/assets/vendor/icon-set/style.css}">
    <link rel="stylesheet" th:href="@{/assets/css/theme.min.css?v=1.0}">
    <style> 
        .avatar {
            width: 50px;
            height: 50px;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        .responsive-table {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th,
        td {
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f8f9fa;
        }

        @media (max-width: 768px) {
            table thead {
                display: none;
            }

            table,
            table tbody,
            table tr,
            table td {
                display: block;
                width: 100%;
            }

            table tr {
                margin-bottom: 15px;
            }

            table td {
                text-align: right;
                position: relative;
                padding-left: 50%;
            }

            table td:before {
                content: attr(data-label);
                position: absolute;
                left: 10px;
                font-weight: bold;
            }

            /* Ảnh bìa */
            .profile-cover {
                position: relative;
                height: 250px;
                overflow: hidden;
                border-radius: 0.75rem;
                box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
            }

            .profile-cover img {
                object-fit: cover;
                width: 100%;
                height: 100%;
                transform: scale(1.1);
                transition: transform 0.5s ease-in-out;
            }

            .profile-cover img:hover {
                transform: scale(1.2);
            }

            .cover-overlay {
                position: absolute;
                bottom: 20px;
                left: 20px;
                background: rgba(0, 0, 0, 0.4);
                padding: 15px;
                border-radius: 5px;
            }

            /* Avatar */
            .avatar-wrapper {
                position: absolute;
                top: -70px;
                left: 50%;
                transform: translateX(-50%);
            }

            .avatar-img {
                width: 140px;
                height: 140px;
                object-fit: cover;
                border-radius: 50%;
                border: 5px solid white;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
                transition: transform 0.3s ease;
            }

            .avatar-img:hover {
                transform: scale(1.05);
            }

            /* Thông tin chi tiết */
            .list-group-item {
                padding: 1.5rem;
                font-size: 1.1rem;
                border-bottom: 1px solid #f0f0f0;
                background-color: #f8f9fa;
            }

            .list-group-item:last-child {
                border-bottom: none;
            }

            .list-group-item strong {
                font-weight: 600;
                color: #333;
            }

            .list-group-item span {
                color: #777;
            }

            /* Gradient text */
            .text-gradient {
                background: -webkit-linear-gradient(45deg, #f39c12, #e74c3c);
                -webkit-background-clip: text;
                color: transparent;
            }

            /* Modal customization */
            .modal-content {
                border-radius: 20px;
                overflow: hidden;
            }

            .modal-header {
                padding: 1.5rem 2rem;
                border-bottom: none;
            }

            .modal-body {
                padding: 3rem 2rem;
            }

            .modal-title {
                font-weight: 700;
                color: #343a40;
                font-size: 1.8rem;
            }

            button[data-dismiss="modal"] {
                position: absolute;
                top: 20px;
                right: 20px;
                z-index: 1;
            }

            /* Hiệu ứng hover cho nút đóng */
            button[data-dismiss="modal"]:hover {
                background-color: rgba(0, 0, 0, 0.1);
                border-radius: 50%;
            }

        }
    </style>
</head>

<body>
    <div th:replace="fragments/headerMain"></div>
    <div id="headerFluid" class="d-none">
        <header id="header"
            class="navbar navbar-expand-xl navbar-fixed navbar-height navbar-flush navbar-container navbar-bordered">
            <div class="js-mega-menu navbar-nav-wrap">
                <div class="navbar-brand-wrapper">
                    <a class="navbar-brand" th:href="@{/}" aria-label="Front">
                        <img class="navbar-brand-logo" th:src="@{/svg/logos/logo.svg}" alt="Logo">
                    </a>
                </div>
            </div>
        </header>
    </div>
    <div id="headerDouble" class="d-none">
        <header id="header" class="navbar navbar-expand-lg navbar-bordered flex-lg-column px-0">
        </header>
    </div>
    <div th:replace="fragments/sidebarMain"></div>
    <div id="sidebarCompact" class="d-none">
        <aside
            class="js-navbar-vertical-aside navbar navbar-vertical-aside navbar-vertical navbar-vertical-fixed navbar-expand-xl navbar-bordered">
            <div class="navbar-vertical-container">
                <div class="navbar-vertical-content">
                </div>
            </div>
        </aside>
    </div>
    <div th:replace="fragments/searchDropdown"></div>
    <div id="content" role="main" class="main pointer-event">
        <div th:include="fragments/managerPage :: content"></div>
        <div th:replace="fragments/users/managerDetailsModel"></div>
    </div>
    </div>

    <script th:src="@{/assets/js/demo.js}"></script>
    <script th:src="@{/assets/js/vendor.min.js}"></script>
    <script th:src="@{/assets/js/theme.min.js}"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js/dist/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>

    <script>
        function loadUserDetails(userId) {
            const token = localStorage.getItem('authToken');

            // Gửi yêu cầu HTTP đến API
            fetch(`http://localhost:8080/onboarding/users/${userId}`, {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.status) {
                        const user = data.data;

                        // Hiển thị thông tin vào các phần tử DOM
                        document.getElementById('managerFullNameDetails').innerText = user.fullname || 'Full name not available';

                        const managerRolesDetails = document.getElementById('managerRolesDetails');
                        managerRolesDetails.innerText = user.roles ? user.roles.join(", ") : 'Role not available';

                        const managerEmailDetails = document.getElementById('managerEmailDetails');
                        managerEmailDetails.innerText = user.email;

                        const managerPhoneNumberDetails = document.getElementById('managerPhoneNumberDetails');
                        managerPhoneNumberDetails.innerText = user.phoneNumber;
                        const status = user.isLocked === 'OPEN' ? 'Tài khoản mở' : 'Bị khóa';
                        const managerStatusDetails = document.getElementById('managerStatusDetails');
                        managerStatusDetails.innerText = status;

                        const managerBioDetails = document.getElementById('managerBioDetails');
                        managerBioDetails.innerText = user.bio ?? "";

                        const managerDioDetails = document.getElementById('managerDioDetails');
                        managerDioDetails.innerText = user.dob ?? "";

                        const managerCreateTimeDetails = document.getElementById('managerCreateTimeDetails');
                        if (user.create_at) {
                            const createdDate = new Date(user.create_at).toLocaleDateString('vi-VN', {
                                day: '2-digit',
                                month: '2-digit',
                                year: 'numeric',
                            });
                            managerCreateTimeDetails.innerText = 'Joined ' + createdDate;
                        } else {
                            managerCreateTimeDetails.innerText = 'Join date not available';
                        }

                        // Hiển thị modal
                        const modal = new bootstrap.Modal(document.getElementById('managerDetailsModel'));
                        modal.show();
                    } else {
                        console.error('API Error:', data.message || 'Unknown error');
                    }
                })
                .catch(error => {
                    console.error('Lỗi khi tải thông tin người dùng:', error.message);
                });
        }


        $(document).on('ready', function () {
            $('.js-navbar-vertical-aside-toggle-invoker').click(function () {
                $('.js-navbar-vertical-aside-toggle-invoker i').tooltip('hide');
            });
            var megaMenu = new HSMegaMenu($('.js-mega-menu'), {
                desktop: {
                    position: 'left'
                }
            }).init();
            var sidebar = $('.js-navbar-vertical-aside').hsSideNav();
            $('.js-nav-tooltip-link').tooltip({ boundary: 'window' });
            $(".js-nav-tooltip-link").on("show.bs.tooltip", function (e) {
                if (!$("body").hasClass("navbar-vertical-aside-mini-mode")) {
                    return false;
                }
            });
        });
        $('.js-hs-unfold-invoker').each(function () {
            var unfold = new HSUnfold($(this)).init();
        });
    </script>


    <script src="/be/src/main/resources/static/assets/js/manager.js"></script>

</body>

</html>