<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Post</title>
</head>

<body>
    <h2>Test api</h2>

    <!-- Input để chọn file ảnh -->
    <input type="file" id="fileInput" accept="image/*" />
    <!-- Input để nhập nội dung bài viết -->
    <input type="text" id="postContent" placeholder="Enter your post content" />
    <!-- Nút để tạo bài viết -->
    <button onclick="createPost()">Create</button>

    <script>
        // Hàm để gửi bài viết và ảnh lên server
        const createPost = () => {
            const content = document.getElementById("postContent").value; // Lấy nội dung bài viết
            const fileInput = document.getElementById("fileInput"); // Lấy input file
            const file = fileInput.files[0]; // Lấy file đầu tiên nếu có

            const formData = new FormData(); // Tạo FormData để gửi dữ liệu

            // Thêm nội dung bài viết vào FormData
            formData.append("comment", JSON.stringify({
                "content": "Xin chào tôi là bạn tôi  là Minh",
                "postId": 3,
                "userId": 2,
                "type": "POST"
            }));

            // Thêm file vào FormData
            formData.append("imageFile", file);

            // Gửi request tới server bằng fetch API
            fetch("http://localhost:8080/api/comments", {
                method: "POST",
                headers: {
                    "Authorization": "Bearer eyJhbGciOiJIUzUxMiJ9.eyJpc3MiOiJxdXluaGxtLmRldkBnbWFpbC5jb20iLCJzdWIiOiJMZSBtYW5oIHF1eW5oIiwiZXhwIjoxNzMyODQ2MjQ2LCJpYXQiOjE3MzI3NTk4NDYsInNjb3BlIjoiVVNFUiJ9.W-HbDxaGgSweZo12O7LHPvrWLFOurOwcIVzLkW-Y9KP5DMyCg0oDbHkUjli2UNRZg91dphy7M13AiLbCgen4Lg", // Thêm token nếu cần
                },
                body: formData,
            })
                .then(response => response.json())
                .then(data => {
                    console.log("Post created successfully:", data);
                    alert("Post created successfully!");
                })
                .catch(error => {
                    console.error("Error creating post:", error);
                    alert("Error creating post");
                });
        };
    </script>
</body>

</html>